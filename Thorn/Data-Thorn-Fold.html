<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Data.Thorn.Fold</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Data-Thorn-Fold.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Data-Thorn-Fold.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">thorn-0.2: Datatype Manipulation with Template Haskell</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Data.Thorn.Fold</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Folding and Unfolding
</a><ul><li><a href="#g:2">Mutual Recursion
</a></li><li><a href="#g:3">Helper Function
</a></li><li><a href="#g:4">Primitive Functions
</a></li></ul></li><li><a href="#g:5">Examples
</a><ul><li><a href="#g:6">Basic
</a></li><li><a href="#g:7">Mutual Recursion
</a></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The module Data.Thorn.Fold.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:unfixdata">unfixdata</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a>) -&gt; [<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Syntax.html#t:Name">Name</a>] -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></li><li class="src short"><a href="#v:autofold">autofold</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autofoldtype">autofoldtype</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></li><li class="src short"><a href="#v:autofolddec">autofolddec</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></li><li class="src short"><a href="#v:autounfold">autounfold</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autounfoldtype">autounfoldtype</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></li><li class="src short"><a href="#v:autounfolddec">autounfolddec</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></li><li class="src short"><a href="#v:unfixdataMutual">unfixdataMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a>, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a>, [<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Syntax.html#t:Name">Name</a>])] -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></li><li class="src short"><a href="#v:autofoldMutual">autofoldMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autofoldtypeMutual">autofoldtypeMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></li><li class="src short"><a href="#v:autofolddecMutual">autofolddecMutual</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></li><li class="src short"><a href="#v:autounfoldMutual">autounfoldMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autounfoldtypeMutual">autounfoldtypeMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></li><li class="src short"><a href="#v:autounfolddecMutual">autounfolddecMutual</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></li><li class="src short"><a href="#v:modifynameUf">modifynameUf</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:autoin">autoin</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autoout">autoout</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autohylo">autohylo</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autoinMutual">autoinMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autooutMutual">autooutMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li><li class="src short"><a href="#v:autohyloMutual">autohyloMutual</a> :: [<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></li></ul></div><div id="interface"><h1 id="g:1">Folding and Unfolding
</h1><div class="doc"><p>You can generate folds and unfolds from various kinds of recursive datatypes, including mutually recursive ones.
</p></div><div class="top"><p class="src"><a name="v:unfixdata" class="def">unfixdata</a><a href="src/Data-Thorn-Fold.html#unfixdata" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>t</code>, recursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a></td><td class="doc"><p><code>s</code>, name of the datatype to be declared
</p></td></tr><tr><td class="src">-&gt; (<a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a>)</td><td class="doc"><p><code>f</code>, how to convert the name of data constructors
</p></td></tr><tr><td class="src">-&gt; [<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Syntax.html#t:Name">Name</a>]</td><td class="doc"><p><code>ds</code>, derivings
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></td><td class="doc"><p>declaration of a nonrecursive datatype whose fixpoint is <code>t</code>
</p></td></tr></table></div><div class="doc"><p><code>unfixdata t n f ds</code> provides a declaration of a nonrecursive datatype whose fixpoint is the recursive type <code>t</code>, with a deriving declaration with names <code>ds</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autofold" class="def">autofold</a><a href="src/Data-Thorn-Fold.html#autofold" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>u</code>, nonrecursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>t</code>, fixpoint of <code>u</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>fold with a type <code>(u x0 .. xn a -&gt; a) -&gt; (t x0 .. xn -&gt; a)</code>
</p></td></tr></table></div><div class="doc"><p><code>autofold u t</code> provides a fold for the recursive type <code>t</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autofoldtype" class="def">autofoldtype</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a><a href="src/Data-Thorn-Fold.html#autofoldtype" class="link">Source</a></p><div class="doc"><p><code>autofoldtype u t</code> provides the type of <code>$(<code><a href="Data-Thorn-Fold.html#v:autofold">autofold</a></code> u t)</code>, that is, <code>(u x0 .. xn a -&gt; a) -&gt; (t x0 .. xn -&gt; a)</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autofolddec" class="def">autofolddec</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a><a href="src/Data-Thorn-Fold.html#autofolddec" class="link">Source</a></p><div class="doc"><p><code>autofolddec s u t</code> provides a declaration of a fold for the recursive type <code>t</code> with the name <code>s</code>, with a type signature.
</p></div></div><div class="top"><p class="src"><a name="v:autounfold" class="def">autounfold</a><a href="src/Data-Thorn-Fold.html#autounfold" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>u</code>, nonrecursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>t</code>, fixpoint of <code>u</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>unfold with a type <code>(a -&gt; u x0 .. xn a) -&gt; (a -&gt; t x0 .. xn)</code>
</p></td></tr></table></div><div class="doc"><p><code>autounfold u t</code> provides an unfold for the recursive type <code>t</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autounfoldtype" class="def">autounfoldtype</a> :: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a><a href="src/Data-Thorn-Fold.html#autounfoldtype" class="link">Source</a></p><div class="doc"><p><code>autounfoldtype u t</code> provides the type of <code>$(<code><a href="Data-Thorn-Fold.html#v:autounfold">autounfold</a></code> u t)</code>, that is, <code>(a -&gt; u x0 .. xn a) -&gt; (a -&gt; t x0 .. xn)</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autounfolddec" class="def">autounfolddec</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a><a href="src/Data-Thorn-Fold.html#autounfolddec" class="link">Source</a></p><div class="doc"><p><code>autounfolddec s u t</code> provides a declaration of an unfold for the recursive type <code>t</code> with the name <code>s</code>, with a type signature.
</p></div></div><h2 id="g:2">Mutual Recursion
</h2><div class="top"><p class="src"><a name="v:unfixdataMutual" class="def">unfixdataMutual</a><a href="src/Data-Thorn-Fold.html#unfixdataMutual" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a>, <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a>, [<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Syntax.html#t:Name">Name</a>])]</td><td class="doc"><p><code>[(t0,s0,f0,ds0), ...]</code>; recursive datatype, name of the datatype to be declared, how to convert the name of data constructors, and derivings
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a></td><td class="doc"><p>declarations of datatypes <code>u0, u1, u2, ...</code>, whose fixpoints are <code>t0, t1, t2, ...</code> respectively
</p></td></tr></table></div><div class="doc"><p>Mutually recursive version of <code><a href="Data-Thorn-Fold.html#v:unfixdata">unfixdata</a></code>. Note that
</p><pre><code><a href="Data-Thorn-Fold.html#v:unfixdata">unfixdata</a></code> t s f ds = <code><a href="Data-Thorn-Fold.html#v:unfixdataMutual">unfixdataMutual</a></code> [(t,s,f,ds)]</pre></div></div><div class="top"><p class="src"><a name="v:autofoldMutual" class="def">autofoldMutual</a><a href="src/Data-Thorn-Fold.html#autofoldMutual" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)]</td><td class="doc"><p><code>[(u0,t0), .., (un,tn)]</code>; <code>ui</code> is a nonrecursive datatype and <code>ti</code> is a fixpoint of <code>ui</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a></td><td class="doc"><p><code>k</code>, index
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>fold with a type <code>(u0 x0 .. xm a0 .. an -&gt; a0) -&gt; .. -&gt; (un x0 .. xm a0 .. an -&gt; an) -&gt; (tk x0 .. xm -&gt; ak)</code>
</p></td></tr></table></div><div class="doc"><p><code>autofoldMutual uts k</code> provides a fold for the mutually recursive type <code>tk</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autofoldtypeMutual" class="def">autofoldtypeMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a><a href="src/Data-Thorn-Fold.html#autofoldtypeMutual" class="link">Source</a></p><div class="doc"><p><code>autofoldtypeMutual uts k</code> provides the type of <code>$(<code><a href="Data-Thorn-Fold.html#v:autofoldMutual">autofoldMutual</a></code> uts k)</code>, that is, <code>(u0 x0 .. xm a0 .. an -&gt; a0) -&gt; .. -&gt; (un x0 .. xm a0 .. an -&gt; an) -&gt; (tk x0 .. xm -&gt; ak)</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autofolddecMutual" class="def">autofolddecMutual</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a><a href="src/Data-Thorn-Fold.html#autofolddecMutual" class="link">Source</a></p><div class="doc"><p><code>autofolddecMutual s uts k</code> provides a declaration of a fold for the mutually recursive type <code>tk</code> with the name <code>s</code>, with a type signature.
</p></div></div><div class="top"><p class="src"><a name="v:autounfoldMutual" class="def">autounfoldMutual</a><a href="src/Data-Thorn-Fold.html#autounfoldMutual" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)]</td><td class="doc"><p><code>[(u0,t0), .., (un,tn)]</code>; <code>ui</code> is a nonrecursive datatype and <code>ti</code> is a fixpoint of <code>ui</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a></td><td class="doc"><p><code>k</code>, index
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>unfold with a type <code>(a0 -&gt; u0 x0 .. xm a0 .. an) -&gt; .. -&gt; (an -&gt; un x0 .. xm a0 .. an) -&gt; (ak -&gt; tk x0 .. xm)</code>
</p></td></tr></table></div><div class="doc"><p><code>autounfoldMutual uts k</code> provides an unfold for the mutually recursive type <code>tk</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autounfoldtypeMutual" class="def">autounfoldtypeMutual</a> :: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a><a href="src/Data-Thorn-Fold.html#autounfoldtypeMutual" class="link">Source</a></p><div class="doc"><p><code>autounfoldtypeMutual uts k</code> provides the type of <code>$(<code><a href="Data-Thorn-Fold.html#v:autounfoldMutual">autounfoldMutual</a></code> uts k)</code>, that is, <code>(a0 -&gt; u0 x0 .. xm a0 .. an) -&gt; .. -&gt; (an -&gt; un x0 .. xm a0 .. an) -&gt; (ak -&gt; tk x0 .. xm)</code>.
</p></div></div><div class="top"><p class="src"><a name="v:autounfolddecMutual" class="def">autounfolddecMutual</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)] -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:DecsQ">DecsQ</a><a href="src/Data-Thorn-Fold.html#autounfolddecMutual" class="link">Source</a></p><div class="doc"><p><code>autounfolddecMutual s uts k</code> provides a declaration of an unfold for the mutually recursive type <code>tk</code> with the name <code>s</code>, with a type signature.
</p></div></div><h2 id="g:3">Helper Function
</h2><div class="top"><p class="src"><a name="v:modifynameUf" class="def">modifynameUf</a> :: <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-String.html#t:String">String</a><a href="src/Data-Thorn-Fold.html#modifynameUf" class="link">Source</a></p><div class="doc"><p>Use this function to designate how to convert the name of data constructors for <code><a href="Data-Thorn-Fold.html#v:unfixdata">unfixdata</a></code>.
</p><pre> modifynameUf &quot;Hello&quot; == &quot;UfHello&quot;
 modifynameUf &quot;:***&quot; == &quot;:&amp;***&quot;
</pre><p>Note that
</p><pre><code><a href="Data-Thorn-Fold.html#v:modifynameUf">modifynameUf</a></code> == <code><a href="Data-Thorn-Basic.html#v:modifyname">modifyname</a></code> (&quot;Uf&quot;,&quot;&quot;) (&quot;&amp;&quot;,&quot;&quot;)</pre></div></div><h2 id="g:4">Primitive Functions
</h2><div class="top"><p class="src"><a name="v:autoin" class="def">autoin</a><a href="src/Data-Thorn-Fold.html#autoin" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>u</code>, nonrecursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>t</code>, fixpoint of <code>u</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>function with a type <code>u x0 .. xn (t x0 .. xn) -&gt; t x0 .. xn</code>
</p></td></tr></table></div></div><div class="top"><p class="src"><a name="v:autoout" class="def">autoout</a><a href="src/Data-Thorn-Fold.html#autoout" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>u</code>, nonrecursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>t</code>, fixpoint of <code>u</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>function with a type <code>t x0 .. xn -&gt; u x0 .. xn (t x0 .. xn)</code>
</p></td></tr></table></div></div><div class="top"><p class="src"><a name="v:autohylo" class="def">autohylo</a><a href="src/Data-Thorn-Fold.html#autohylo" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a></td><td class="doc"><p><code>u</code>, nonrecursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>function with a type <code>(a -&gt; u x0 .. xn a) -&gt; (u x0 .. xn b -&gt; b) -&gt; (a -&gt; b)</code>
</p></td></tr></table></div></div><div class="top"><p class="src"><a name="v:autoinMutual" class="def">autoinMutual</a><a href="src/Data-Thorn-Fold.html#autoinMutual" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)]</td><td class="doc"><p><code>[(u0,t0), .., (un,tn)]</code>; <code>ui</code> is a nonrecursive datatype and <code>ti</code> is a fixpoint of <code>ui</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a></td><td class="doc"><p><code>k</code>, index
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>function with a type <code>uk x0 .. xm (t0 x0 .. xm) .. (tn x0 .. xm) -&gt; tk x0 .. xm</code>
</p></td></tr></table></div><div class="doc"><p>Mutually recursive version of <code><a href="Data-Thorn-Fold.html#v:autoin">autoin</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:autooutMutual" class="def">autooutMutual</a><a href="src/Data-Thorn-Fold.html#autooutMutual" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>, <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>)]</td><td class="doc"><p><code>[(u0,t0), .., (un,tn)]</code>; <code>ui</code> is a nonrecursive datatype and <code>ti</code> is a fixpoint of <code>ui</code>
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a></td><td class="doc"><p><code>k</code>, index
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>function with a type <code>tk x0 .. xm -&gt; uk x0 .. xm (t0 x0 .. xm) .. (tn x0 .. xm)</code>
</p></td></tr></table></div><div class="doc"><p>Mutually recursive version of <code><a href="Data-Thorn-Fold.html#v:autoout">autoout</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:autohyloMutual" class="def">autohyloMutual</a><a href="src/Data-Thorn-Fold.html#autohyloMutual" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:TypeQ">TypeQ</a>]</td><td class="doc"><p><code>[u0, .., un]</code>; <code>ui</code> is a nonrecursive datatype
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Int.html#t:Int">Int</a></td><td class="doc"><p><code>k</code>, index
</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/template-haskell/latest/doc/html/Language-Haskell-TH-Lib.html#t:ExpQ">ExpQ</a></td><td class="doc"><p>function with a type <code>(a0 -&gt; u0 x0 .. xm a0 .. an) -&gt; .. -&gt; (an -&gt; un x0 .. xm a0 .. an) -&gt; (u0 x0 .. xm b0 .. bn -&gt; b0) -&gt; .. -&gt; (un x0 .. xm b0 .. bn -&gt; bn) -&gt; (ak -&gt; bk)</code>
</p></td></tr></table></div><div class="doc"><p>Mutually recursive version of <code><a href="Data-Thorn-Fold.html#v:autohylo">autohylo</a></code>.
</p></div></div><h1 id="g:5">Examples
</h1><h2 id="g:6">Basic
</h2><div class="doc"><p>It's a piece of cake.
</p><p>Note tht <code>foldlist</code> is analogous with <code><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:foldr">foldr</a></code> and <code>unfoldlist</code> with <code><a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:unfoldr">unfoldr</a></code>.
</p><pre> data List a = Nil | a :* (List a) deriving Show
 
 unfixdata [t|List|] &quot;UfList&quot; modifynameUf [''Show]
 -- data UfList a self = UfNil | a :&amp;* self deriving Show
 
 autofolddec &quot;foldlist&quot; [t|UfList|] [t|List|]
 autounfolddec &quot;unfoldlist&quot; [t|UfList|] [t|List|]
 
 fib :: List Int
 fib = unfoldlist go (0,1)
       -- 1 :* (1 :* (2 :* (3 :* (5 :* (8 :* (13 :* Nil))))))
     where go :: (Int,Int) -&gt; UfList Int (Int,Int)
           go (a,b)
             | b &gt; 20 = UfNil
             | otherwise = b :&amp;* (b,a+b)
 
 fibsum :: Int
 fibsum = foldlist add fib
          -- 33
     where add :: UfList Int Int -&gt; Int
           add UfNil = 0
           add (m :&amp;* n) = m+n
 
 normalfib :: [Int]
 normalfib = foldlist go fib
             -- [1,1,2,3,5,8,13]
     where go :: UfList a [a] -&gt; [a]
           go UfNil = []
           go (a :&amp;* as) = a:as
</pre></div><h2 id="g:7">Mutual Recursion
</h2><div class="doc"><p>It also works for mutual recursion.
</p><p>Just an extension of simple recursion. Take it easy.
</p><pre> data Rose x = x :-&lt; (Forest x) deriving Show
 data Forest x = F [Rose x] deriving Show
 
 unfixdataMutual [([t|Rose|],&quot;UfRose&quot;,modifynameUf,[''Show]), ([t|Forest|],&quot;UfForest&quot;,modifynameUf,[''Show])]
 -- data UfRose x rose forest = x :&amp;-&lt; forest deriving Show
 -- data UfForest x rose forest = UfF [rose] deriving Show
 
 autofolddecMutual &quot;foldrose&quot; [([t|UfRose|],[t|Rose|]),([t|UfForest|],[t|Forest|])] 0
 -- foldrose :: (UfRose x a b -&gt; a) -&gt; (UfForest x a b -&gt; b) -&gt; Rose x -&gt; a
 -- foldrose = ...
 autounfolddecMutual &quot;unfoldrose&quot; [([t|UfRose|],[t|Rose|]),([t|UfForest|],[t|Forest|])] 0
 -- unfoldrose :: (a -&gt; UfRose x a b) -&gt; (b -&gt; UfForest x a b) -&gt; a -&gt; Rose x
 -- unfoldrose = ...
 
 rose :: Rose Int
 rose = unfoldrose gorose goforest 0
        -- 0 :-&lt; F [1 :-&lt; F [3 :-&lt; F [],4 :-&lt; F []],2 :-&lt; F [5 :-&lt; F [],6 :-&lt; F []]]
     where gorose :: Int -&gt; UfRose Int Int Int
           gorose n
             | n &gt; 2 = n :&amp;-&lt; (-1)
             | otherwise = n :&amp;-&lt; n
           goforest :: Int -&gt; UfForest Int Int Int
           goforest (-1) = UfF []
           goforest n = UfF [n*2+1,n*2+2]
 
 showrose :: Show x =&gt; Rose x -&gt; String
 showrose = unlines . foldrose gorose goforest
     where gorose :: Show x =&gt; UfRose x [String] [String] -&gt; [String]
           gorose (x :&amp;-&lt; ls) = [show x] ++ ls
           goforest :: UfForest x [String] [String] -&gt; [String]
           goforest (UfF []) = []
           goforest (UfF lss) = concatMap hang (init lss) ++ hang' (last lss)
           hang ls = [&quot;|&quot;] ++ [&quot;+--&quot; ++ head ls] ++ map (&quot;|  &quot;++) (tail ls)
           hang' ls = [&quot;|&quot;] ++ [&quot;+--&quot; ++ head ls] ++ map (&quot;   &quot;++) (tail ls)
 
 shownrose :: String
 shownrose = showrose rose
 -- 0
 -- |
 -- +--1
 -- |  |
 -- |  +--3
 -- |  |
 -- |  +--4
 -- |
 -- +--2
 --    |
 --    +--5
 --    |
 --    +--6
</pre></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>